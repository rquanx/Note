### 算法

#### 图片灰度转换算法

##### 原理

原色

> 指不能透过其他颜色的混合调配而得出的“基本色”。

> 一般来说叠加型的三原色是红色、绿色、蓝色，以不同比例将原色混合，可以产生出其他的新颜色。这套原色系统常被称为“RGB色彩空间”，亦即由红（R）绿（G）蓝（B）所组合出的色彩系统。



当这三种原色以等比例叠加在一起时，会变成灰色；若将此三原色的强度均调至最大并且等量重叠时，则会呈现白色。灰度就是没有色彩，RGB色彩分量全部相等。



##### 常见算法

###### 平均法

Gray = (Red + Green + Blue) / 3

优点：公式简单，所以易于维护和优化

缺点：灰度阴影和亮度方面做的还不够好



###### 基于人眼感知

根据人眼对颜色的感知程度进行参数调整。

考虑到了人眼对不同光感知程度不同。人的眼睛内有几种辨别颜色的锥形感光细胞，分别对黄绿色、绿色和蓝紫色的光最敏感。

人类对红绿蓝三色的感知程度依次是： 绿>红>蓝



Gray = (Red **0.3 + Green \* 0.59 + Blue** 0.11)

Gray = (Red **0.2126 + Green \* 0.7152 + Blue** 0.0722)

Gray = (Red **0.299 + Green \* 0.587 + Blue** 0.114)



###### 去饱和

使用HLS模型



分别是：Hue(色调)、Saturation(饱和度)、Lightness(亮度)。



色调，取值为：0 - 360，0(或360)表示红色，120表示绿色，240表示蓝色，也可取其他数值来指定颜色。

饱和度，取值为：0.0% - 100.0%，它通常指颜色的鲜艳程度。

亮度，取值为：0.0% - 100.0%，黑色的亮度为0



Gray = ( Math.max(Red, Green, Blue) + Math.min(Red, Green, Blue) ) / 2

> 把RGB转换为HLS，然后将饱和度设为0

> 图片立体感减弱，但是更柔和



###### 分解



Gray = Math.max(Red, Green, Blue)

Gray = Math.min(Red, Green, Blue)

> 均只取最大值或最小值



###### 单一通道



不作计算，直接去单一颜色的值

Gray = Red / Green / Blue

> 大多数数码相机都用这个算法生成灰度图片。很难预测这种转换的结果，所以这种算法多用于艺术效果



###### 自定义灰度阴影



用户提供一个灰色阴影值，值的范围在2-256。2的结果是一张全白的图片，256的结果和平均法一样



ConversionFactor = 255 / (NumberOfShades - 1)

AverageValue = (Red + Green + Blue) / 3

Gray = Math.round((AverageValue / ConversionFactor) + 0.5) * ConversionFactor



##### 应用

滤镜变灰

网站颜色变灰（css filter grayscale）



